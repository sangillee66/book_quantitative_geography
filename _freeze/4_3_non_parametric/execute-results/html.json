{
  "hash": "c1582b2450782203902254fe4efda3ea",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"비모수적 가설검정\"\nauthor: Sang-Il Lee\ndate-modified: last-modified\nnumber-sections: true\nformat: \n  html: \n    toc: true\ncode-link: true\ncode-copy: true\nlightbox: true\nexecute: \n  warning: false\n  error: false\n  freeze: auto\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n## 단일표본 중위수 검정\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ncommu_time <- sample(c(22, 23, 25, 27, 27, 28, 28, 29, 29, 31, 33, 37, 37, 38, 39, 42, 43, 43, 43, 58))\n\nm0 <- 30\n\nd <- commu_time - m0\nd\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] -5  9 -8 -3 -2 12  3  8  7  1  7 13 -2 -1 -3 28 13 -7 -1 13\n```\n\n\n:::\n\n```{.r .cell-code}\nd_abs <- abs(d)\nd_abs\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  5  9  8  3  2 12  3  8  7  1  7 13  2  1  3 28 13  7  1 13\n```\n\n\n:::\n\n```{.r .cell-code}\nranks <- rank(d_abs)\nranks\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  9.0 15.0 13.5  7.0  4.5 16.0  7.0 13.5 11.0  2.0 11.0 18.0  4.5  2.0  7.0\n[16] 20.0 18.0 11.0  2.0 18.0\n```\n\n\n:::\n\n```{.r .cell-code}\nsigned_ranks <- ranks * sign(d)\nsigned_ranks\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  -9.0  15.0 -13.5  -7.0  -4.5  16.0   7.0  13.5  11.0   2.0  11.0  18.0\n[13]  -4.5  -2.0  -7.0  20.0  18.0 -11.0  -2.0  18.0\n```\n\n\n:::\n\n```{.r .cell-code}\nW <- sum(ranks[d > 0])\nW\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 149.5\n```\n\n\n:::\n\n```{.r .cell-code}\ndf_W <- tibble(\n  commu_time, d, d_abs, ranks, signed_ranks\n)\ndf_W\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 5\n   commu_time     d d_abs ranks signed_ranks\n        <dbl> <dbl> <dbl> <dbl>        <dbl>\n 1         25    -5     5   9           -9  \n 2         39     9     9  15           15  \n 3         22    -8     8  13.5        -13.5\n 4         27    -3     3   7           -7  \n 5         28    -2     2   4.5         -4.5\n 6         42    12    12  16           16  \n 7         33     3     3   7            7  \n 8         38     8     8  13.5         13.5\n 9         37     7     7  11           11  \n10         31     1     1   2            2  \n11         37     7     7  11           11  \n12         43    13    13  18           18  \n13         28    -2     2   4.5         -4.5\n14         29    -1     1   2           -2  \n15         27    -3     3   7           -7  \n16         58    28    28  20           20  \n17         43    13    13  18           18  \n18         23    -7     7  11          -11  \n19         29    -1     1   2           -2  \n20         43    13    13  18           18  \n```\n\n\n:::\n\n```{.r .cell-code}\ndf_W |> \n  group_by(signed_ranks >= 0) |> \n  summarize(\n    sum_rank = sum(signed_ranks)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n  `signed_ranks >= 0` sum_rank\n  <lgl>                  <dbl>\n1 FALSE                  -60.5\n2 TRUE                   150. \n```\n\n\n:::\n\n```{.r .cell-code}\n# 부호 검정\n\ndf_W |> summarize(\n  mean(commu_time < 30)\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 1\n  `mean(commu_time < 30)`\n                    <dbl>\n1                    0.45\n```\n\n\n:::\n\n```{.r .cell-code}\nZ_W = (mean(df_W$commu_time < 30) - 0.5)/sqrt(0.45*0.55/20)\nZ_W\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -0.4494666\n```\n\n\n:::\n\n```{.r .cell-code}\nP_Z_W = 2*(pnorm(Z_W))\nP_Z_W\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6530951\n```\n\n\n:::\n\n```{.r .cell-code}\nwilcox.test(commu_time, mu = 30)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  commu_time\nV = 149.5, p-value = 0.09992\nalternative hypothesis: true location is not equal to 30\n```\n\n\n:::\n\n```{.r .cell-code}\nwilcox <- (60.5 - 20*21/4)/sqrt(20*21*41/24)\nwilcox\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.661304\n```\n\n\n:::\n\n```{.r .cell-code}\n2*(pnorm(wilcox))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.09665245\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}